function PromotionItem(t){this.init(t),this.render(),this.countDownTime()}$(function(){$.ajax({url:"/api/promotions/one_money/1/items",success:function(t){console.log(t),t.map(function(t){new PromotionItem(t)})},error:function(t){$("body").append(t.responseText)}})}),PromotionItem.prototype={init:function(t){var s=["avatar_urls","cover_urls","image_urls"],a=["start_at","end_at"];for(var n in t){var i=t[n];s.indexOf(n)>-1&&(i=JSON.parse(i)),a.indexOf(n)>-1&&(i=Date.parse(i)),this[n]=i}},getStatus:function(){return this.status?this.status:Date.now()<this.start_at?"wait":Date.now()>this.end_at?"expired":this.total_amount<1?"shortage":"sale"},countDownTime:function(){var t=$(".promotion-item[name="+this.id+"] .count-time");new CountDown(t,+this.total_amount,this.start_at,this.end_at)},changeStatus:function(){},statusFlagTemplate:function(){switch(this.getStatus()){case"wait":return'<span class="status wait">未开始</span>&emsp;参与人数:'+this.total_amount;case"expired":return'<span class="status end">已结束</span>&emsp;参与人数:'+this.total_amount;case"shortage":return'<span class="status end">已售罄</span>&emsp;参与人数:'+this.total_amount;default:return'<span class="status">抢购中</span>&emsp;库存:'+this.total_amount}},template:function(){return'<li class="promotion-item" name='+this.id+'>              <a class="item-wrap" href="detail.html?one_money_id='+this.one_money_id+"&id="+this.id+'">                <header>                  <img class="one-money-logo" src="images/one_money_log.jpg"/>                  <img class="cover" src="'+this.cover_urls[0]+'">                  <div class="limit">                    <span class="count-time"></span>                  </div>                </header>                <main>                  <p class="title">'+this.title+'</p>                  <div class="price-wrap">                    <span class="now-price">￥'+this.price+'</span>                    <span class="origin-price">原价<s>￥'+this.ori_price+'&nbsp;</s></span>                  </div>                  <div class="status-wrap">'+this.statusFlagTemplate()+"</div>                </main>              </a>            </li>"},render:function(t){var t=t||$(".promotions-list");t.append(this.template())}};