<div id="template-<%= template.id %>" class="edit-preview-template" data-preview-url="<%= preview_admins_subject_template_path(subject, template) %>">
  <ul class="nav nav-tabs">
    <li role="presentation" class="active">
      <a href="#edit-template-<%= template.id %>" role="tab" data-toggle="tab">编辑</a>
    </li>
    <li role="presentation">
      <a href="#preview-template-<%= template.id %>" class="preview-template-tab" role="tab" data-toggle="tab">预览</a>
    </li>
  </ul>

  <div class="tab-content">
    <% url = admins_subject_template_path(subject, template) %>
    <%= render partial: "admins/subjects/edit_template", locals: {subject: subject, template: template, url: url} %>

    <div id="preview-template-<%= template.id %>" class="tab-pane panel panel-default preview-template fade">
      <div class="panel-heading">
        <h3 class="panel-title"></h3>
      </div>
      <div class="preview">
        <iframe src="<%= preview_layout_admins_subject_templates_path(subject) %>" style="border: none;"></iframe>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">
  (function() {
    var EditTemplate = window.EditTemplate;
    var templateName = "template-<%= template.id %>";
    var editorName= "template-editor-<%= template.id %>";
    var url = "<%= url %>";

    var editor = new EditTemplate($('#' + templateName), editorName, { url: url });
  })();
</script>
