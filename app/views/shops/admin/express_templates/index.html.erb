<div class='alert-header no-bottom-border'>
  <div class="alert alert-success infors" role="alert" style='display: none;'>
  </div>
  <div class="alert alert-danger errors" role="alert" style='display: none;'>
  </div>
</div>

<div class="panel panel-default">
  <div class="panel-heading">运费模板管理</div>
  <div class="panel-body">
    <table class='table express-templates table-hover'>
      <thead>
        <tr>
          <th colspan='2'>
            本店运费模板
          </th>
          <th>
            <%= link_to "点击添加运费模板", new_shop_admin_express_template_path, class: 'btn btn-default' %>
          </th>
        </tr>
        <tr>
          <th width='20%'>名称</th>
          <th width='60%'>运费描述</th>
          <th width='20%'>操作</th>
        </tr>
      </thead>
      <tbody>
        <% if @express_templates.blank? %>
          <tr>
            <td colspan='3' class='text-center'>
              暂无运费模板
              <%= link_to "点击添加运费模板", new_shop_admin_express_template_path, class: 'btn btn-default' %>
            </td>
          </tr>
        <% else %>
          <% @express_templates.each do |template| %>
            <% isDefault = current_shop.default_express_template_id == template.id %>
            <tr class="<%= isDefault ? 'info' : '' %>" data-template-id="<%= template.id %>">
              <td>
                <%= template.name %>
                <% if isDefault %>
                  <span class="label label-info chosen">默认</span>
                <% else %>
                  <span class="label label-info chosen" style='display: none;'>默认</span>
                <% end %>
              </td>
              <td>
                <%= render_express_template_desc template %>
              </td>
              <td>
                <%= link_to "编辑", edit_shop_admin_express_template_path(current_shop.name, template), class: 'btn btn-default' %>

                <%= button_to "删除", shop_admin_express_template_path(current_shop.name, template), method: :delete, data: { confirm: "确定删除模板\"#{template.name}\"么?" }, class: 'btn btn-danger' %>

                <%= button_to "设置为默认", set_default_shop_admin_express_templates_path(current_shop.name, template_id: template.id), 
                  remote: true,
                  method: :post,
                  format: 'js',
                  style: "#{isDefault ?  'display: none;' : ''}",
                  class: 'btn btn-default chose', 
                  data: { confirm: "<span class='label label-warning'>*注意</span>如果设置了商店的默认运费模板，则所有没有设置运费模板的商品都会自动应用该模板。确定设置\"#{template.name}\"为本店默认模板么？"}  
                %>

                <%= button_to "取消默认", cancel_default_shop_admin_express_templates_path(current_shop.name), 
                  remote: true,
                  method: :post,
                  format: 'js',
                  style: "#{isDefault ?  '' : 'display: none;'}",
                  class: 'btn btn-warning chosen', 
                  data: { confirm: "<span class='label label-warning'>*注意</span>如果取消默认商店的默认运费模板，则所有没有设置运费模板的商品运费都会为0。确定取消默认模板么？"}  
                %>
              </td>
            </tr>
          <% end %>
        <% end %>
      </tbody>
    </table>
  </div>
  <div class="panel-footer">
    <span class="label label-warning">*注意</span>如果设置了商店的默认运费模板，则所有没有设置运费模板的商品都会自动应用该模板。如果没有设置商店的默认模板，也没有设置商品自身的模板，则运费计算总是为０元。</div>
</div>
