<div class="panel panel-default panel-item-edit">
  <div class="panel-heading">
    <h3>创建自己的产品
      <small> ->
      <ol class="breadcrumb">
        <% @breadcrumb.each do |bread| %>
          <li><a href="javascript:void(0)"><%= bread.title.humanize %></a></li>
        <% end %>
        <li class="active"><%= @category.title %></li>
      </ol> </small></h3>
  </div>
  <div class="panel-body">
    <%= form_for @item, url: new_step2_shopitems_path(@shop.name, category_id: @category), html: { class: "form-horizontal" } do |f| %>

      <!-- 错误显示 -->
      <% if @item.errors.any? %>
      <div class="list-group col-sm-offset-2 col-sm-10">
        <% @item.errors.full_messages.each do |msg| %>
          <a href="#" class="list-group-item list-group-item-danger"><%= msg %></a>
        <% end %>
      </div>
      <% end %>

      <!-- 图片 -->
      <div class="form-group">
        <%= f.label :images, class: "col-sm-2 control-label" %>
        <div class="col-sm-10">
          <% @item.images.each do |image| %>
            <%= image %>
          <% end %>
        </div>
      </div>

      <!-- 标题 -->
      <% group_with_errors @item, :title, f do %>
        <%= f.text_field :title, class: 'form-control' %>
      <% end %>

      <!-- 品牌 -->
      <% group_with_errors @item, :brand_id, f do %>
        <%= f.select :brand_id, options_from_collection_for_select(Brand.all, 'id', 'title'), {}, class: 'form-control' %>
      <% end %>

      <!-- 参考价 -->
      <% group_with_errors @item, :price, f do %>
          <%= f.number_field :price, class: 'form-control' %>
      <% end %>

      <!-- 零售价 -->
      <% group_with_errors @item, :public_price, f do %>
          <%= f.number_field :public_price, class: 'form-control' %>
      <% end %>

      <!-- 进货价 -->
      <% group_with_errors @item, :income_price, f do %>
          <%= f.number_field :income_price, class: 'form-control' %>
      <% end %>

      <!-- 商店分类 -->
      <% group_with_errors @item, :shop_category_id, f do %>
        <%= f.select :shop_category_id, options_from_collection_for_select(@shop.shop_category.descendants, 'id', 'title'), {}, class: 'form-control' %>
      <% end %>

      <hr />

      <% if Settings.dev.feature.dynamic_property %>

      <!-- 枚举全部属性 -->
      <% @properties.each do |property| %>
      <div class="form-group">
        <% property_name = "property_#{property.name}" %>
        <%= label_tag property_name, property.title, class: "col-sm-2 control-label" %>
        <div class="col-sm-10">
          <%= property_edit "item", property %>
        </div>
      </div>
        <%# group_with_property_errors @item, property, f do %>
          <%#= property_edit "item", property %>
        <%# end %>
      <% end %>

      <% end %>

      <!-- 详情 -->
      <% group_with_errors @item, :description, f do %>
        <%= f.bootsy_area :description, class: "form-control", rows: 12 %>
      <% end %>
      <!-- 隐藏字段 -->
      <%= f.hidden_field :category_id %>

      <div class="form-group">
        <div class="col-sm-offset-2 col-sm-10">
          <%= f.submit class: "btn btn-primary btn-lg" %>
        </div>
      </div>
    <% end %>
  </div>
</div>
