<table class='table table-bordered order'>
  <colgroup>
    <col width="24%" />
    <col width="20%" />
    <col width="12%" />
    <col width="12%" />
    <col width="12%" />
    <col width="20%" />
  </colgroup>

  <tbody>
    <tr class='head'>
      <td colspan='6'>
        <span>订单号: <%= order.id %></span>
        <span class='create-time'>创建时间：<%= order.created_at.strftime("%Y/%m/%d %H:%M") %></span>
        <span class='buyer pull-right'>客户：<%= order.buyer.username %></span>
      </td>
    </tr>
    <%= render partial: "order_item", collection: order.items, as: :item, locals: { order: order, supplier: order.supplier } %>
    <tr>
      <td colspan='6'>
        <h4 class='text-right'>
          一共<%= order.items_count %> 件商品&emsp;合计：
          <span class='total'><%= number_to_currency order.total %>元</span>
        </h4>
      </td>
    </tr>
  </tbody>
</table>

<div class="modal fade" id="change-total-<%= order.id %>" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <%= form_for order, url: shop_admin_order_path(order.supplier.name, order) do |f| %>
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="myModalLabel">修改第<%= order.id %>号订单总价</h4>
        </div>
        <div class="modal-body">
          <div class="form-group">
            原价：<span class='order-total'><%= number_to_currency order.total %></span>
          </div>
          <div class="form-inline">
            <div class="form-group">
              <label for="new-order-total-<%= order.id %>">修改为：</label>
              <%= f.number_field :total, class: "form-control", id: "new-order-total-#{ order.id }", placeholder: "输入新的订单总价", autocomplete: "off", step: 0.1 %>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
          <%= f.submit "确定修改", class: "btn btn-primary confirm-order-change" %>
        </div>
      </div>
    </div>
  <% end %>
</div>

